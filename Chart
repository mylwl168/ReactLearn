import React from "react";
import { Chart as ChartJS, BarElement, CategoryScale, LinearScale, Tooltip, Title } from "chart.js";
import { Bar } from "react-chartjs-2";

ChartJS.register(BarElement, CategoryScale, LinearScale, Tooltip, Title);

const data = {
  labels: ["A", "B", "C", "D", "E"],
  datasets: [
    {
      label: "Dataset 1",
      data: [12, 19, 3, 5, 2],
      backgroundColor: "rgba(75, 192, 192, 0.6)",
    },
  ],
};

const options = {
  responsive: true,
  plugins: {
    legend: { display: false },
  },
  scales: {
    x: {
      ticks: {
        color: "black", // 确保 X 轴的文字是黑色
        font: {
          weight: "bold",
        },
      },
    },
  },
};

const BlackBoxPlugin = {
  id: "blackBox",
  beforeDraw: (chart: any) => {
    const ctx = chart.ctx;
    const xAxis = chart.scales.x;
    if (!xAxis) return;

    const boxHeight = 24; // 边框高度
    const lineWidth = xAxis.options.grid.lineWidth || 1; // X 轴的线宽

    // 计算边框的范围
    const left = xAxis.left;
    const right = xAxis.right;
    const top = xAxis.top + lineWidth / 2; // 上边缘与 X 轴对齐
    const bottom = top + boxHeight;

    // 绘制透明填充的黑色边框
    ctx.strokeStyle = "black";
    ctx.lineWidth = lineWidth;
    ctx.strokeRect(left, top, right - left, boxHeight);
  },
};

const BarChart = () => {
  return <Bar data={data} options={options} plugins={[BlackBoxPlugin]} />;
};

export default BarChart;

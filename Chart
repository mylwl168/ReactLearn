const BlackBoxPlugin = {
  id: "blackBox",
  beforeDraw: (chart: Chart) => {
    const { ctx, scales: { x }, chartArea } = chart;
    
    // ğŸ¯ Xè»¸ã®ãƒ©ãƒ™ãƒ«ã‚¨ãƒªã‚¢ã®é«˜ã•ã‚’æ±ºå®š
    const boxHeight = 20; // ã™ã¹ã¦ã®ãƒ©ãƒ™ãƒ«ã«çµ±ä¸€ã®é«˜ã•ã‚’è¨­å®š
    const yBottom = x.bottom + boxHeight; // Xè»¸ã®ä¸‹ã«ãƒœãƒƒã‚¯ã‚¹ã‚’é…ç½®

    ctx.save(); // ğŸ¯ ç¾åœ¨ã®æç”»çŠ¶æ…‹ã‚’ä¿å­˜

    // ğŸ¯ å„ãƒ©ãƒ™ãƒ«ã®ä¸‹ã«é»’ã„ãƒœãƒƒã‚¯ã‚¹ã‚’æç”»
    x.ticks.forEach((tick, index) => {
      const xLeft = x.getPixelForTick(index); // ç¾åœ¨ã®ãƒ©ãƒ™ãƒ«ã®Xåº§æ¨™
      const xRight = index < x.ticks.length - 1 
        ? x.getPixelForTick(index + 1) 
        : chartArea.right; // æœ€å¾Œã®ãƒ©ãƒ™ãƒ«ã¯å³ç«¯ã¾ã§åºƒã’ã‚‹

      // ğŸ”³ é»’ã„ãƒœãƒƒã‚¯ã‚¹ã®æç”»ï¼ˆé€æ˜ãªèƒŒæ™¯ + é»’ã„æ ç·šï¼‰
      ctx.fillStyle = "transparent"; // å†…éƒ¨ã¯é€æ˜
      ctx.fillRect(xLeft, x.bottom, xRight - xLeft, boxHeight);

      ctx.strokeStyle = "black"; // æ ç·šã‚’é»’ã«è¨­å®š
      ctx.lineWidth = x.grid.lineWidth; // Xè»¸ã®å¤ªã•ã¨çµ±ä¸€
      ctx.strokeRect(xLeft, x.bottom, xRight - xLeft, boxHeight);
    });

    // ğŸ¯ Xè»¸ã®ä¸‹ã«1æœ¬ã®åˆ†å‰²ç·šã‚’å¼•ãï¼ˆé€£ç¶šçš„ãªãƒœãƒƒã‚¯ã‚¹ã«ã™ã‚‹ãŸã‚ï¼‰
    ctx.strokeStyle = "black";
    ctx.lineWidth = x.grid.lineWidth;
    ctx.beginPath();
    ctx.moveTo(chartArea.left, yBottom);
    ctx.lineTo(chartArea.right, yBottom);
    ctx.stroke();

    ctx.restore(); // ğŸ¯ æç”»çŠ¶æ…‹ã‚’å…ƒã«æˆ»ã™
  },
};
